---
layout: topic
title: Решето Эратосфена
permalink: topics/primesieve
---

### Определение

Решето Эратосфена - достаточно эффективный алгоритм для нахождения
*всех* простых чисел в отрезке от $$1$$ до $$N$$ за $$O(N \log \log N)$$.

Алгоритм достаточно тривиален: будем перебирать числа по возрастанию,
начиная с $$2$$, зачёркивая все числа, кратные текущему. Например, при обработке
числа $$2$$ будут зачёркнуты числа $$4, 6, 8, \ldots$$. Если мы обнаружили
незачёркнутое число, это значит, что оно простое.

Визуализация работы решета Эратосфена:

<img style="display: block; margin: auto" src="/resources/eratosthenes.gif" />

Работу решета можно значительно ускорить, если начинать зачёркивать
числа, кратные $$p$$, не с $$2p$$, а с $$p^2$$. Ведь числа $$2p, 3p, 5p, \ldots$$ уже
были зачёркнуты при обработке чисел $$2, 3, 5, \ldots$$

### Реализация

{% highlight cpp linenos %}


using namespace std;

bool sieve[1000001];    //решето
vector<int> primes;     //вектор, в который будут добавляться простые числа

void compute_primes(int n) {
    for (int i = 2; i <= n; i++) {   //Изначально все числа не вычеркнуты.
        sieve[i] = true;
    }

    for (int i = 2; i <= n; i++) {
        if (sieve[i]) {     //если i не вычеркнуто
            primes.push_back(i);

            for (int j = i * i; j <= n; j += i) {    //вычеркиваем все кратные числа начиная с i^2
                sieve[j] = false;
            }
        }
    }
}

int main() {
    compute_primes(1000000);

    cout << "Prime numbers: ";
    for (int i: primes) {
        cout << i << ", ";
    }
}
{% endhighlight %}

